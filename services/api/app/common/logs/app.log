2025-09-20 02:55:20,554 :[app] [APP: Startup] Startup began...
2025-09-20 02:55:20,554 :[app] [APP: Startup] Startup began...
2025-09-20 02:55:20,554 :[app] [APP: Startup] Startup began...
2025-09-20 02:55:20,555 :[app] [APP: Startup] Startup began...
2025-09-20 02:55:20,916 :[app] [APP: Startup] Startup finished!
2025-09-20 02:55:20,916 :[app] [APP: Startup] Startup finished!
2025-09-20 02:55:20,916 :[app] [APP: Startup] Startup finished!
2025-09-20 02:55:20,916 :[app] [APP: Startup] Startup finished!
2025-09-20 02:59:31,240 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 02:59:31,240 :[app] [CACHE: USERS] Caching user id=14, username=josh3
2025-09-20 03:01:54,468 :[app] [APP: Startup] Startup began...
2025-09-20 03:01:54,468 :[app] [APP: Startup] Startup began...
2025-09-20 03:01:54,469 :[app] [APP: Startup] Startup began...
2025-09-20 03:01:54,469 :[app] [APP: Startup] Startup began...
2025-09-20 03:01:54,847 :[app] [APP: Startup] Startup finished!
2025-09-20 03:01:54,847 :[app] [APP: Startup] Startup finished!
2025-09-20 03:01:54,847 :[app] [APP: Startup] Startup finished!
2025-09-20 03:01:54,847 :[app] [APP: Startup] Startup finished!
2025-09-20 03:03:39,789 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 03:03:39,808 :[app] [CACHE: USERS] Caching user id=14, username=josh4
2025-09-20 03:11:43,331 :[app] [APP: Startup] Startup began...
2025-09-20 03:11:43,344 :[app] [APP: Startup] Startup began...
2025-09-20 03:11:43,352 :[app] [APP: Startup] Startup began...
2025-09-20 03:11:43,353 :[app] [APP: Startup] Startup began...
2025-09-20 03:12:03,484 :[app] [APP: Startup] Startup finished!
2025-09-20 03:12:03,484 :[app] [APP: Startup] Startup finished!
2025-09-20 03:12:03,484 :[app] [APP: Startup] Startup finished!
2025-09-20 03:12:03,484 :[app] [APP: Startup] Startup finished!
2025-09-20 03:12:15,847 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 03:12:15,847 :[app] [CACHE: USERS] Caching user id=14, username=josh5
2025-09-20 03:12:53,863 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 03:12:53,928 :[app] [CACHE: USERS] Caching user id=14, username=josh6
2025-09-20 03:27:15,633 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:15,633 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:15,633 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:15,634 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:20,546 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:20,638 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:20,685 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:24,900 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:24,933 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:24,940 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:25,043 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:29,247 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:29,464 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:33,579 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:33,600 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:33,657 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:33,754 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:38,810 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:38,817 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:39,038 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:39,040 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:45,177 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:45,293 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:45,468 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:55,052 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:55,063 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:55,228 :[app] [APP: Startup] Startup began...
2025-09-20 03:27:55,305 :[app] [APP: Startup] Startup began...
2025-09-20 03:28:22,476 :[app] [APP: Startup] Startup began...
2025-09-20 03:28:22,646 :[app] [APP: Startup] Startup began...
2025-09-20 03:28:22,674 :[app] [APP: Startup] Startup began...
2025-09-20 03:28:22,725 :[app] [APP: Startup] Startup began...
2025-09-20 03:28:32,544 :[app] [APP: Startup] Startup finished!
2025-09-20 03:28:32,662 :[app] [APP: Startup] Startup finished!
2025-09-20 03:28:32,693 :[app] [APP: Startup] Startup finished!
2025-09-20 03:28:32,750 :[app] [APP: Startup] Startup finished!
2025-09-20 03:28:49,730 :[app] [CACHE: USERS] Caching user id=14, username=josh6
2025-09-20 03:28:49,977 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 03:28:49,978 :[app] [CACHE: USERS] Caching user id=14, username=josh
2025-09-20 03:29:24,672 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 03:29:24,688 :[app] [CACHE: USERS] Caching user id=14, username=josh2
2025-09-20 03:35:58,892 :[app] [APP: Startup] Startup began...
2025-09-20 03:35:59,019 :[app] [APP: Startup] Startup began...
2025-09-20 03:35:59,022 :[app] [APP: Startup] Startup began...
2025-09-20 03:35:59,130 :[app] [APP: Startup] Startup began...
2025-09-20 03:36:08,928 :[app] [APP: Startup] Startup finished!
2025-09-20 03:36:09,047 :[app] [APP: Startup] Startup finished!
2025-09-20 03:36:09,047 :[app] [APP: Startup] Startup finished!
2025-09-20 03:36:09,154 :[app] [APP: Startup] Startup finished!
2025-09-20 03:36:24,412 :[app] [CACHE: USERS] Caching user id=14, username=josh2
2025-09-20 03:36:24,630 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 03:36:24,631 :[app] [CACHE: USERS] Caching user id=14, username=josh
2025-09-20 03:37:28,657 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 03:37:28,692 :[app] [CACHE: USERS] Caching user id=14, username=josh2
2025-09-20 03:37:56,352 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 03:37:56,392 :[app] [CACHE: USERS] Caching user id=14, username=josh5
2025-09-20 03:39:41,279 :[app] [APP: Startup] Startup began...
2025-09-20 03:39:41,348 :[app] [APP: Startup] Startup began...
2025-09-20 03:39:41,427 :[app] [APP: Startup] Startup began...
2025-09-20 03:39:41,528 :[app] [APP: Startup] Startup began...
2025-09-20 03:39:51,311 :[app] [APP: Startup] Startup finished!
2025-09-20 03:39:51,373 :[app] [APP: Startup] Startup finished!
2025-09-20 03:39:51,449 :[app] [APP: Startup] Startup finished!
2025-09-20 03:39:51,552 :[app] [APP: Startup] Startup finished!
2025-09-20 03:40:07,518 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 03:40:07,533 :[app] [CACHE: USERS] Caching user id=14, username=josh2
2025-09-20 03:51:09,598 :[app] [APP: Startup] Startup began...
2025-09-20 03:51:09,598 :[app] [APP: Startup] Startup began...
2025-09-20 03:51:09,598 :[app] [APP: Startup] Startup began...
2025-09-20 03:51:09,598 :[app] [APP: Startup] Startup began...
2025-09-20 03:51:09,944 :[app] [APP: Startup] Startup finished!
2025-09-20 03:51:09,944 :[app] [APP: Startup] Startup finished!
2025-09-20 03:51:09,944 :[app] [APP: Startup] Startup finished!
2025-09-20 03:51:09,944 :[app] [APP: Startup] Startup finished!
2025-09-20 03:51:25,749 :[app] [CACHE: USERS] Caching user id=14, username=josh2
2025-09-20 03:51:25,980 :[app] [CACHE: USERS] Invalidating cache for user id=14
2025-09-20 03:51:25,981 :[app] [CACHE: USERS] Caching user id=14, username=josh3
2025-09-20 04:07:32,708 :[app] [APP: Startup] Startup began...
2025-09-20 04:07:32,708 :[app] [APP: Startup] Startup began...
2025-09-20 04:07:32,708 :[app] [APP: Startup] Startup began...
2025-09-20 04:07:32,708 :[app] [APP: Startup] Startup began...
2025-09-20 04:07:32,986 :[app] [APP: Startup] Startup finished!
2025-09-20 04:07:32,986 :[app] [APP: Startup] Startup finished!
2025-09-20 04:07:32,986 :[app] [APP: Startup] Startup finished!
2025-09-20 04:07:32,986 :[app] [APP: Startup] Startup finished!
2025-09-20 04:12:14,873 :[app] [APP: Startup] Startup began...
2025-09-20 04:12:14,873 :[app] [APP: Startup] Startup began...
2025-09-20 04:12:14,873 :[app] [APP: Startup] Startup began...
2025-09-20 04:12:14,873 :[app] [APP: Startup] Startup began...
2025-09-20 04:12:15,001 :[app] [APP: Startup] Startup finished!
2025-09-20 04:12:15,001 :[app] [APP: Startup] Startup finished!
2025-09-20 04:12:15,001 :[app] [APP: Startup] Startup finished!
2025-09-20 04:12:15,001 :[app] [APP: Startup] Startup finished!
2025-09-20 04:13:37,067 :[app] [APP: Startup] Startup began...
2025-09-20 04:13:37,176 :[app] [APP: Startup] Startup began...
2025-09-20 04:13:37,206 :[app] [APP: Startup] Startup began...
2025-09-20 04:13:37,207 :[app] [APP: Startup] Startup began...
2025-09-20 04:13:47,156 :[app] [APP: Startup] Startup finished!
2025-09-20 04:13:47,222 :[app] [APP: Startup] Startup finished!
2025-09-20 04:13:47,240 :[app] [APP: Startup] Startup finished!
2025-09-20 04:13:47,245 :[app] [APP: Startup] Startup finished!
2025-09-20 04:14:52,807 :[app] [APP: Startup] Startup began...
2025-09-20 04:14:52,854 :[app] [APP: Startup] Startup began...
2025-09-20 04:14:52,948 :[app] [APP: Startup] Startup began...
2025-09-20 04:14:52,951 :[app] [APP: Startup] Startup began...
2025-09-20 04:15:02,848 :[app] [APP: Startup] Startup finished!
2025-09-20 04:15:02,875 :[app] [APP: Startup] Startup finished!
2025-09-20 04:15:02,967 :[app] [APP: Startup] Startup finished!
2025-09-20 04:15:02,975 :[app] [APP: Startup] Startup finished!
2025-09-20 04:18:20,898 :[app] [APP: Startup] Startup began...
2025-09-20 04:18:20,920 :[app] [APP: Startup] Startup began...
2025-09-20 04:18:20,931 :[app] [APP: Startup] Startup began...
2025-09-20 04:18:21,030 :[app] [APP: Startup] Startup began...
2025-09-20 04:18:30,945 :[app] [APP: Startup] Startup finished!
2025-09-20 04:18:30,949 :[app] [APP: Startup] Startup finished!
2025-09-20 04:18:30,956 :[app] [APP: Startup] Startup finished!
2025-09-20 04:18:31,056 :[app] [APP: Startup] Startup finished!
2025-09-22 18:27:34,828 :[app] [APP: Startup] Startup began...
2025-09-22 18:27:34,828 :[app] [APP: Startup] Startup began...
2025-09-22 18:27:34,828 :[app] [APP: Startup] Startup began...
2025-09-22 18:27:34,828 :[app] [APP: Startup] Startup began...
2025-09-22 18:27:36,716 :[app] [APP: Startup] Startup finished!
2025-09-22 18:27:36,716 :[app] [APP: Startup] Startup finished!
2025-09-22 18:27:36,716 :[app] [APP: Startup] Startup finished!
2025-09-22 18:27:36,716 :[app] [APP: Startup] Startup finished!
2025-09-23 14:04:47,394 :[app] [APP: Startup] Startup began...
2025-09-23 14:04:47,394 :[app] [APP: Startup] Startup began...
2025-09-23 14:04:47,395 :[app] [APP: Startup] Startup began...
2025-09-23 14:04:47,396 :[app] [APP: Startup] Startup began...
2025-09-23 14:04:59,194 :[app] [APP: Startup] Startup finished!
2025-09-23 14:04:59,194 :[app] [APP: Startup] Startup finished!
2025-09-23 14:04:59,194 :[app] [APP: Startup] Startup finished!
2025-09-23 14:04:59,194 :[app] [APP: Startup] Startup finished!
2025-09-23 22:59:44,803 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 22:59:44,805 :[app] POST COMMIT HOOK IN ACTION
2025-09-23 22:59:56,830 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:04:17,410 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:04:30,502 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:06:59,694 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:07:12,209 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:08:25,744 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:08:39,596 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:18:38,294 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:18:51,974 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:20:14,887 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:20:27,496 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:27:46,952 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:27:58,961 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:31:40,869 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:31:53,032 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:34:57,802 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:35:09,817 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:44:16,780 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-23 23:44:29,061 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:03:59,363 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:04:12,551 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:07:41,678 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:07:54,352 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:09:43,977 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:09:56,644 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:11:39,295 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:11:52,769 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:13:46,960 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:14:03,169 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:16:17,327 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:16:33,911 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:20:24,406 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:20:40,904 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:23:02,771 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:23:19,124 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:32:54,487 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:35:29,664 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 00:35:45,461 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 01:12:30,528 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 01:12:43,112 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 01:37:50,562 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 01:38:03,135 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 01:38:06,476 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 281, in connect
    await self.retry.call_with_retry(
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 697, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 58, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 611, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1064, in get_connection
    await self.ensure_connection(connection)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1097, in ensure_connection
    await connection.connect()
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 289, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -2 connecting to redis:6379. Name or service not known.
2025-09-24 01:41:06,518 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 01:41:19,200 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 01:41:22,481 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 281, in connect
    await self.retry.call_with_retry(
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 697, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1083, in create_connection
    infos = await self._ensure_resolved(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 1466, in _ensure_resolved
    return await loop.getaddrinfo(host, port, family=family, type=type,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 905, in getaddrinfo
    return await self.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/socket.py", line 978, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 58, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 611, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1064, in get_connection
    await self.ensure_connection(connection)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 1097, in ensure_connection
    await connection.connect()
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 289, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error -2 connecting to redis:6379. Name or service not known.
2025-09-24 01:43:38,254 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 01:43:38,255 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 58, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 01:43:38,313 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 01:43:51,572 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 01:43:51,573 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 58, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:18:06,954 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:18:06,954 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:18:07,102 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:18:23,720 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:18:23,721 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:18:50,323 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:18:50,324 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:19:09,994 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:19:09,995 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:19:24,854 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:19:24,855 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:19:38,462 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:19:38,462 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:19:50,854 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:19:50,855 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:20:03,586 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:20:03,586 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:20:17,101 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:20:17,102 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:20:30,880 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:20:30,881 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:20:47,894 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:20:47,895 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:21:00,061 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:21:00,062 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:21:12,059 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:21:12,060 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:21:24,585 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:21:24,585 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:21:36,768 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:21:36,769 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:21:48,120 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:21:48,120 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:22:00,859 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:22:00,860 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:22:12,475 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:22:12,476 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:22:23,834 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:22:23,835 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:22:36,110 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:22:36,110 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:22:48,741 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:22:48,741 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:23:00,252 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:23:00,252 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:23:12,795 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:23:12,795 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:23:12,854 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:23:25,100 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:23:25,101 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:23:36,784 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:23:36,785 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:23:48,949 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:23:48,950 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:24:00,852 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:24:00,852 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:24:13,491 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:24:13,491 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:24:24,742 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:24:24,742 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:24:35,902 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:24:35,903 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:24:47,983 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:24:47,983 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:24:59,492 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:24:59,492 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:25:11,675 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:25:11,675 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:25:24,928 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:25:24,928 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:25:41,737 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:25:41,738 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:26:05,058 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:26:05,058 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:26:39,690 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:26:39,691 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:27:40,616 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:27:40,616 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:28:50,522 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:28:50,523 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:28:50,579 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:30:00,048 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:30:00,049 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:31:09,898 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:31:09,899 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:32:20,012 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:32:20,013 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:33:30,429 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:33:30,430 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:34:41,098 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:34:41,099 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:34:41,154 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:34:53,713 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:34:53,713 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:35:05,490 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:35:05,490 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:35:17,851 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:35:17,852 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:35:30,186 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:35:30,187 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:35:42,136 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:35:42,136 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:35:53,661 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:35:53,661 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:36:07,128 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:36:07,129 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:36:23,493 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:36:23,493 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:36:46,548 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:36:46,548 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:37:22,152 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:37:22,152 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:38:23,947 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:38:23,948 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:39:33,471 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:39:33,471 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:40:43,133 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:40:43,134 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:40:43,190 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:41:52,742 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:41:52,742 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:43:02,750 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:43:02,750 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:44:12,471 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:44:12,471 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:45:22,982 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:45:22,983 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:46:32,215 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:46:32,215 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:46:32,270 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:47:42,296 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:47:42,296 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:48:51,742 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:48:51,742 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:50:02,066 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:50:02,067 :[app.uow] Exception while executing post-commit coroutine hook
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 52, in run_hooks
    await result
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:51:11,547 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 43, in run_hooks
    hook_coroutine = hook_callable()
                     ^^^^^^^^^^^^^^^
TypeError: 'tuple' object is not callable
2025-09-24 21:51:13,287 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 43, in run_hooks
    hook_coroutine = hook_callable()
                     ^^^^^^^^^^^^^^^
TypeError: 'tuple' object is not callable
2025-09-24 21:52:22,601 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:52:22,601 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 40, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:52:22,661 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:53:32,212 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:53:32,213 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 40, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 21:54:42,956 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 39, in run_hooks
    hook_coroutine = hook_callable()
                     ^^^^^^^^^^^^^^^
TypeError: 'coroutine' object is not callable
2025-09-24 21:55:53,227 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 39, in run_hooks
    hook_coroutine = hook_callable()
                     ^^^^^^^^^^^^^^^
TypeError: 'coroutine' object is not callable
2025-09-24 21:57:02,856 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 39, in run_hooks
    hook_coroutine = hook_callable()
                     ^^^^^^^^^^^^^^^
TypeError: 'coroutine' object is not callable
2025-09-24 21:58:12,333 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 39, in run_hooks
    hook_coroutine = hook_callable()
                     ^^^^^^^^^^^^^^^
TypeError: 'coroutine' object is not callable
2025-09-24 21:58:12,387 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 21:59:22,733 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 39, in run_hooks
    hook_coroutine = hook_callable()
                     ^^^^^^^^^^^^^^^
TypeError: 'coroutine' object is not callable
2025-09-24 22:01:11,293 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 39, in run_hooks
    hook_coroutine = hook_callable()
                     ^^^^^^^^^^^^^^^
TypeError: 'coroutine' object is not callable
2025-09-24 22:01:11,347 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:01:23,815 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 39, in run_hooks
    hook_coroutine = hook_callable()
                     ^^^^^^^^^^^^^^^
TypeError: 'coroutine' object is not callable
2025-09-24 22:07:46,462 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 42, in run_hooks
    hook_coroutine = hook_factory()
                     ^^^^^^^^^^^^^^
TypeError: 'coroutine' object is not callable
2025-09-24 22:07:46,515 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:08:00,118 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 42, in run_hooks
    hook_coroutine = hook_factory()
                     ^^^^^^^^^^^^^^
TypeError: 'coroutine' object is not callable
2025-09-24 22:09:06,137 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:09:06,138 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 44, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:09:06,193 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:09:17,578 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:09:17,578 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 44, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:10:45,780 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:10:45,781 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:10:57,469 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:10:57,470 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:11:08,336 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:11:08,337 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:11:20,794 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:11:20,795 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:16:19,549 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:16:19,550 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:16:19,605 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:18:52,232 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:18:52,233 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:22:44,488 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:22:44,488 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:22:44,549 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:24:15,379 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:24:15,379 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:24:15,442 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:29:49,743 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:29:49,743 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:29:49,803 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:39:16,155 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:39:16,155 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:39:16,208 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:39:40,894 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:39:40,894 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:39:40,947 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:42:31,620 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:42:31,621 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:42:31,676 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:47:12,793 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:47:12,793 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:47:12,851 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:49:35,503 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:49:35,503 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:49:35,558 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:59:43,356 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 22:59:43,356 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 22:59:43,437 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 23:32:33,285 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 23:32:33,285 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'RedisConnectionManager' object has no attribute 'set'
2025-09-24 23:32:33,462 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 23:35:04,445 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 23:35:04,446 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'set'
2025-09-24 23:35:04,498 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 23:36:17,108 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-24 23:39:00,468 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 00:04:21,687 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 00:06:55,171 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 00:09:51,327 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 00:12:48,409 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:13:45,864 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:14:47,726 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:16:58,063 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:20:34,102 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:23:49,383 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:25:23,633 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:27:36,499 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:32:29,116 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:44:27,090 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:45:21,093 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 01:46:11,511 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:16:25,094 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:23:48,150 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:23:49,930 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 02:23:49,937 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:24:52,471 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:36:31,757 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:38:18,335 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:38:32,931 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:43:33,771 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:43:34,762 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 02:43:34,769 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:53:34,660 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 02:54:29,871 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 03:06:01,192 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 03:06:29,429 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 14:23:05,665 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 14:26:53,089 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 14:32:06,615 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 14:47:36,597 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 14:59:20,540 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 15:01:00,547 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 15:45:14,012 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 15:45:14,020 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
          ^^^^^^^^^^^^^^^
AttributeError: 'async_generator' object has no attribute 'set'
2025-09-25 15:45:14,183 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 15:47:22,212 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 15:55:54,596 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:00:11,097 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:00:11,098 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-10' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:00:11,167 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:03:22,596 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:03:22,597 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-10' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:03:22,658 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:05:50,890 :[app] [CACHE: USERS] Caching user id=1, username=admin
2025-09-25 16:16:26,975 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:16:26,976 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-10' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:16:27,140 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:17:53,062 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:17:53,063 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-10' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:17:53,126 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:25:14,080 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:25:14,081 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-10' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:25:14,136 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:26:35,197 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:26:35,198 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-11' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:26:35,254 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:31:24,354 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:31:24,355 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-11' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:31:24,412 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:35:12,078 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:35:12,079 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-10' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:35:12,138 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:35:27,805 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:35:27,806 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-10' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:35:27,863 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:36:35,554 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:36:35,555 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-10' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:36:35,612 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:40:11,354 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:40:11,355 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-10' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:18> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:40:11,411 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:54:26,440 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:54:26,441 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-9' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:20> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:54:26,599 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 16:54:28,095 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 16:54:28,096 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-65' coro=<test_get_user() running at /app/tests/integration/presentation/test_api_users.py:35> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 16:54:28,102 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:10:56,669 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:10:58,564 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 17:10:58,564 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-78' coro=<test_get_user() running at /app/tests/integration/presentation/test_api_users.py:35> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 569, in read_response
    await self.disconnect(nowait=True)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 425, in disconnect
    self._writer.close()  # type: ignore[union-attr]
    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 358, in close
    return self._transport.close()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/selector_events.py", line 1213, in close
    super().close()
  File "/usr/local/lib/python3.12/asyncio/selector_events.py", line 875, in close
    self._loop.call_soon(self._call_connection_lost, None)
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 799, in call_soon
    self._check_closed()
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 545, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed
2025-09-25 17:10:58,574 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:20:55,491 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:20:57,120 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 17:20:57,120 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-78' coro=<test_get_user() running at /app/tests/integration/presentation/test_api_users.py:35> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 569, in read_response
    await self.disconnect(nowait=True)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 425, in disconnect
    self._writer.close()  # type: ignore[union-attr]
    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 358, in close
    return self._transport.close()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/selector_events.py", line 1213, in close
    super().close()
  File "/usr/local/lib/python3.12/asyncio/selector_events.py", line 875, in close
    self._loop.call_soon(self._call_connection_lost, None)
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 799, in call_soon
    self._check_closed()
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 545, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed
2025-09-25 17:20:57,130 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:24:39,631 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:24:41,320 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 17:24:41,321 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-78' coro=<test_get_user() running at /app/tests/integration/presentation/test_api_users.py:35> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 569, in read_response
    await self.disconnect(nowait=True)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 425, in disconnect
    self._writer.close()  # type: ignore[union-attr]
    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 358, in close
    return self._transport.close()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/selector_events.py", line 1213, in close
    super().close()
  File "/usr/local/lib/python3.12/asyncio/selector_events.py", line 875, in close
    self._loop.call_soon(self._call_connection_lost, None)
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 799, in call_soon
    self._check_closed()
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 545, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed
2025-09-25 17:24:41,330 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:28:00,265 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:28:02,088 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 17:28:02,089 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-69' coro=<test_get_user() running at /app/tests/integration/presentation/test_api_users.py:35> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 569, in read_response
    await self.disconnect(nowait=True)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 425, in disconnect
    self._writer.close()  # type: ignore[union-attr]
    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 358, in close
    return self._transport.close()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/selector_events.py", line 1213, in close
    super().close()
  File "/usr/local/lib/python3.12/asyncio/selector_events.py", line 875, in close
    self._loop.call_soon(self._call_connection_lost, None)
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 799, in call_soon
    self._check_closed()
  File "/usr/local/lib/python3.12/asyncio/base_events.py", line 545, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed
2025-09-25 17:28:02,098 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:42:18,850 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:42:20,369 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 17:42:20,374 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:44:48,619 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:44:50,029 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 17:44:50,068 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:51:11,332 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:51:12,710 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 17:51:12,760 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:52:27,337 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:52:28,706 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 17:52:28,728 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:56:41,200 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 17:56:42,593 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 17:56:42,645 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:01:33,540 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:01:34,671 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 18:03:50,228 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:03:52,078 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 18:03:52,084 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:05:29,286 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:05:30,635 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 18:05:30,682 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:09:46,004 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:09:46,646 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 18:10:40,632 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:10:40,633 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-8' coro=<test_login() running at /app/tests/integration/presentation/test_api_auth.py:20> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 18:10:40,689 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:10:42,410 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 18:10:42,411 :[app] Exception while executing post-commit hook.
Traceback (most recent call last):
  File "/app/app/infrastructure/db/sqla_uow.py", line 36, in run_hooks
    await hook_coroutine
  File "/app/app/infrastructure/repositories/users.py", line 220, in __cache
    await self._redis.set(f'user:{user.id}', user.model_dump_json(), ex=USER_CACHE_TTL_SECONDS)
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 616, in execute_command
    return await conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 590, in _send_command_parse_response
    return await self.parse_response(conn, command_name, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/client.py", line 637, in parse_response
    response = await connection.read_response()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/asyncio/connection.py", line 549, in read_response
    response = await self._parser.read_response(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 82, in read_response
    response = await self._read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/resp2.py", line 90, in _read_response
    raw = await self._readline()
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/app/.venv/lib/python3.12/site-packages/redis/_parsers/base.py", line 219, in _readline
    data = await self._stream.readline()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 568, in readline
    line = await self.readuntil(sep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 660, in readuntil
    await self._wait_for_data('readuntil')
  File "/usr/local/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-66' coro=<test_get_user() running at /app/tests/integration/presentation/test_api_users.py:35> cb=[_run_until_complete_cb() at /usr/local/lib/python3.12/asyncio/base_events.py:181]> got Future <Future pending> attached to a different loop
2025-09-25 18:10:42,441 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:12:29,075 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:12:30,186 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 18:16:40,462 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:16:41,635 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 18:16:41,657 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:17:49,779 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:17:51,252 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 18:17:51,299 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:20:01,378 :[app] [CACHE: USERS] Caching user id=1, username=test
2025-09-25 18:20:02,469 :[app] [CACHE: USERS] Caching user id=2, username=admin
2025-09-25 18:20:02,497 :[app] [CACHE: USERS] Caching user id=1, username=test
